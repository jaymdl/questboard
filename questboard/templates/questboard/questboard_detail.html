{% extends "base.html" %}
{% block content %}
{% if request.user.is_authenticated %}
    <div class="shadow p-5 mb-5 bg-white rounded">
        {% if request.user == teacher %}
        <div class="mb-5">
            <a href="#" class="badge badge-dark" data-toggle="modal" data-target="#editQuestboardModal{{ questboard.pk }}">Edit</a>
        </div>
        
        <div class="modal fade" id="editQuestboardModal{{ questboard.pk }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">Edit Item</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <form method='POST' action="{% url 'update_questboard' questboard.pk %}"> {% csrf_token %}
                    {{ edit_questboard_form.as_p }}
                    <input type='submit' class="btn btn-primary"" value='Update' />
                    </form>
                  </div>
                  <div class="modal-footer">
                  </div>
                </div>
              </div>
        </div>
        {% endif %}
        <small class="d-flex self-align-center">Questboard </small>
        <h1 class="display-6">  {{ questboard.name }} </h1>
        <p class="lead">
              {{ questboard.description }}
        </p>
        <dl class="row">
              <dt class="col-sm-6">Required number of stars to fulfill this course: </dt>
              <dd class="col-sm-6"> {{ questboard.required_stars }} stars</dd>
            
              <dt class="col-sm-3">Euismod</dt>
              <dd class="col-sm-9">
                <p>Vestibulum id ligula porta felis euismod semper eget lacinia odio sem nec elit.</p>
                <p>Donec id elit non mi porta gravida at eget metus.</p>
              </dd>
            
              
        </dl>
    </div>
    {% if request.user == teacher %}
    <div class="mb-5">
        <a type="button" class="btn btn-primary btn-lg btn-block" href="{% url 'create_quest' questboard.pk %}" type="submit">Create a Quest.</a>
    </div>
    {% endif %}
    
    <div class ="row mt-3">
    {% for quest in quests %}
    <div class="col-lg-4 col-md-6 col-sm-12 mb-5">
        <div class="card shadow p-1 mx-3 mb-5 bg-white rounded h-100" style="width: 20rem;">
              <div class="card-body">
                <h5 class="card-title">{{ quest.name }}</h5>
                <p class="card-text"> {{ quest.description }}</p>
              </div>
              
              {% if not quest.for_everyone %}
              
              <ul class="list-group list-group-flush">
                {% if quest.member_one %}
                <li class="list-group-item">{{ quest.member_one }}</li>
                {% else %}
                <form method="POST" action="{% url 'add_member_one' quest.pk %}"> {% csrf_token %}
                    <li class="list-group-item d-flex justify-content-between">{{ member_one_form.member_one }} 
                        <button type="button" class="btn btn-warning self-align-start" data-toggle="modal" data-target="#confirmJoinModalOne{{ quest.pk }}">
                            <small>Join</small>
                        </button> 
                    </li>
                    
                    <div class="modal fade" id="confirmJoinModalOne{{ quest.pk }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                          <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLongTitle">Join this quest?</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                  <span aria-hidden="true">&times;</span>
                                </button>
                              </div>
                              <div class="modal-body">
                               <button type="submit" class="btn btn-info btn-sm">Yes</button>
                               <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">No</button>
                              </div>
                              <div class="modal-footer">
                              </div>
                            </div>
                          </div>
                    </div>
                
                
                </form>
                {% endif %}
              </ul>
              
              
              
              <ul class="list-group list-group-flush">
                  {% if quest.member_two %}
                  <li class="list-group-item">{{ quest.member_two }}</li>
                  {% else %}
                  <form method="POST" action="{% url 'add_member_two' quest.pk %}"> {% csrf_token %}
                      <li class="list-group-item d-flex justify-content-between">{{ member_two_form.member_two }} 
                          <button type="button" class="btn btn-warning self-align-start" data-toggle="modal" data-target="#confirmJoinModalTwo{{ quest.pk }}">
                              <small>Join</small>
                          </button> 
                      </li>
                      
                      <div class="modal fade" id="confirmJoinModalTwo{{ quest.pk }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="exampleModalLongTitle">Join this quest?</h5>
                                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                  </button>
                                </div>
                                <div class="modal-body">
                                 <button type="submit" class="btn btn-info btn-sm">Yes</button>
                                 <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">No</button>
                                </div>
                                <div class="modal-footer">
                                </div>
                              </div>
                            </div>
                      </div>
                  
                  
                  </form>
                  {% endif %}
              </ul>
                
              <ul class="list-group list-group-flush">
                    {% if quest.member_three %}
                      <li class="list-group-item">{{ quest.member_three }}</li>
                      {% else %}
                      <form method="POST" action="{% url 'add_member_three' quest.pk %}"> {% csrf_token %}
                          <li class="list-group-item d-flex justify-content-between">{{ member_three_form.member_three }} 
                              <button type="button" class="btn btn-warning self-align-start" data-toggle="modal" data-target="#confirmJoinModalThree{{ quest.pk }}">
                                  <small>Join</small>
                              </button> 
                          </li>
                          
                          <div class="modal fade" id="confirmJoinModalThree{{ quest.pk }}" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered" role="document">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <h5 class="modal-title" id="exampleModalLongTitle">Join this quest?</h5>
                                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                        <span aria-hidden="true">&times;</span>
                                      </button>
                                    </div>
                                    <div class="modal-body">
                                     <button type="submit" class="btn btn-info btn-sm">Yes</button>
                                     <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">No</button>
                                    </div>
                                    <div class="modal-footer">
                                    </div>
                                  </div>
                                </div>
                          </div>
                      
                      
                      </form>
                      {% endif %}
              </ul>
              
              {% else %}
              <ul class="list-group list-group-flush">
                  <li class="list-group-item"> This quest is for everyone</li>
              </ul>
              {% endif %}
              
        </div>
    </div>
    {% endfor %}
    </div>
    
{% endif %}
{% endblock content %}